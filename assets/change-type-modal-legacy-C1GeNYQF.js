!function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?e(Object(s),!0).forEach((function(e){n(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):e(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function n(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./chakra-legacy-VViCoECn.js","./index-legacy-C23MW5NQ.js","./react-legacy-DopGR7tC.js","./master-manager-legacy-CiKnwj18.js"],(function(e,n){"use strict";var r,s,a,i,o,l,c,d,u,g,h,p,y,b,f,m,j,S,O,v,x,A,C,E,T,w,N,P,L,I,k,z,W,D,B,F,M,R,H,_;return{setters:[e=>{r=e.j,s=e.ag,a=e.M,i=e.ah,o=e.J,l=e.N,c=e.K,d=e.L,u=e.aG,g=e.aH,h=e.aI,p=e.B,y=e.aJ,b=e.aK,f=e.O,m=e.t,j=e.aw},e=>{S=e.d,O=e.S,v=e.at,x=e.o,A=e.m,C=e.l,E=e.c,T=e.e,w=e.q,N=e.t,P=e.v,L=e.C,I=e.M,k=e.L,z=e.U,W=e.Q,D=e.R,B=e.V,F=e.i},e=>{M=e.u,R=e.b},e=>{H=e.s,_=e.u}],execute:function(){const n=[O.ShmetroBasic2020,O.LondonTubeBasic,O.ShanghaiSuburbanRailway],q=e("b",((e,r,s)=>{const a=e.getNodeAttribute(r,"type"),i=structuredClone(e.getNodeAttribute(r,a).names);for(let t=0;t<Math.abs(H[s].defaultAttrs.names.length-i.length);t++)H[s].defaultAttrs.names.length>i.length?i.push("Stn"):i.pop();const o=t(t({},H[s].defaultAttrs),{},{names:i});Object.values(n).includes(a)&&Object.values(n).includes(s)||(o.nameOffsetX=e.getNodeAttribute(r,a).nameOffsetX,o.nameOffsetY=e.getNodeAttribute(r,a).nameOffsetY),S.has(s)&&S.has(a)&&(o.color=structuredClone(e.getNodeAttribute(r,a).color)),e.removeNodeAttribute(r,a),e.mergeNodeAttributes(r,{type:s,[s]:o})})),J=e("c",((e,t,n,r)=>{const s=e.getEdgeAttribute(t,"type"),a=e.getEdgeAttribute(t,"style");if(v[a].metadata.supportLinePathType.includes(n)){const a=structuredClone(x[n].defaultAttrs);let i=-1;if(r){const[r,s]=e.extremities(t),o=a.startFrom;i=A(e,n,r,s,o)}e.setEdgeAttribute(t,"parallelIndex",i),e.removeEdgeAttribute(t,s),e.mergeEdgeAttributes(t,{type:n,[n]:a})}})),K=e("a",((e,t,n,r)=>{const s=e.getEdgeAttribute(t,"type"),a=e.getEdgeAttribute(t,"style");if(console.log(v[n].metadata.supportLinePathType),v[n].metadata.supportLinePathType.includes(s)){const s=e.getEdgeAttribute(t,"zIndex"),i=e.getEdgeAttribute(t,a);e.removeEdgeAttribute(t,a);const o=structuredClone(v[n].defaultAttrs);S.has(a)&&S.has(n)?o.color=i.color:S.has(n)&&r&&(o.color=r),e.mergeEdgeAttributes(t,{style:n,[n]:o}),n===C.River?e.setEdgeAttribute(t,"zIndex",-5):e.setEdgeAttribute(t,"zIndex",null!=s?s:0)}}));e("C",(e=>{const{isOpen:n,onClose:A,isSelect:X,filter:Y}=e,{t:Z}=M(),G=E(),{selected:Q}=T((e=>e.runtime)),{preference:{autoParallel:U}}=T((e=>e.app)),{activeSubscriptions:V}=T((e=>e.account)),$=R.useCallback((()=>{G(w(ee.current.export())),G(N()),G(P())}),[G,N,P,w]),ee=R.useRef(window.graph),te=t({any:Z("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(x).map((([e,t])=>[e,Z(t.metadata.displayName).toString()])))),ne=t({any:Z("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(v).map((([e,t])=>[e,Z(t.metadata.displayName).toString()])))),re=t({any:Z("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(H).map((([e,t])=>[e,Z(t.metadata.displayName).toString()])))),se={id:"any",theme:[L.Other,"other","#ffffff",I.black],value:Z("header.settings.procedures.changeType.any")},[ae,ie]=R.useState(!1),[oe,le]=R.useState(0),[ce,de]=R.useState(!1),[ue,ge]=R.useState("any"),[he,pe]=R.useState(O.ShmetroBasic),[ye,be]=R.useState(!1),[fe,me]=R.useState("any"),[je,Se]=R.useState(C.SingleColor),[Oe,ve]=R.useState(!1),[xe,Ae]=R.useState("any"),[Ce,Ee]=R.useState(k.Diagonal),[Te,we]=R.useState(!1),[Ne,Pe]=R.useState(se),{theme:Le,requestThemeChange:Ie}=z(),[ke,ze]=R.useState([]),We=[{id:"changeZIndex",title:Z("header.settings.procedures.changeZIndex"),onClose:()=>ie(!ae),field:[{type:"select",label:Z("panel.details.info.zIndex"),value:oe,options:Object.fromEntries(Array.from({length:11},((e,t)=>[t-5,(t-5).toString()]))),onChange:e=>le(Number(e))}]},{id:"changeStationType",title:Z("header.settings.procedures.changeStationType.title"),onClose:()=>de(!ce),field:[{type:"select",label:Z("header.settings.procedures.changeStationType.changeFrom"),options:re,value:ue,disabledOptions:[he],onChange:e=>ge(e)},{type:"select",label:Z("header.settings.procedures.changeStationType.changeTo"),options:re,value:he,disabledOptions:["any",ue],onChange:e=>pe(e)}]},{id:"changeLineStyleType",title:Z("header.settings.procedures.changeLineStyleType.title"),onClose:()=>be(!ye),field:[{type:"select",label:Z("header.settings.procedures.changeLineStyleType.changeFrom"),options:ne,value:fe,disabledOptions:[je],onChange:e=>me(e)},{type:"select",label:Z("header.settings.procedures.changeLineStyleType.changeTo"),options:ne,value:je,disabledOptions:["any",fe],onChange:e=>Se(e)}]},{id:"changeLinePathType",title:Z("header.settings.procedures.changeLinePathType.title"),onClose:()=>ve(!Oe),field:[{type:"select",label:Z("header.settings.procedures.changeLinePathType.changeFrom"),options:te,value:xe,disabledOptions:[Ce],onChange:e=>Ae(e)},{type:"select",label:Z("header.settings.procedures.changeLinePathType.changeTo"),options:te,value:Ce,disabledOptions:["any","simple",xe],onChange:e=>Ee(e)}]},{id:"changeColor",title:Z("header.settings.procedures.changeColor.title"),onClose:()=>we(!Te),field:[{type:"custom",label:Z("header.settings.procedures.changeColor.changeFrom"),component:r.jsx(W,{data:ke,displayHandler:e=>r.jsx(D,{name:e.value,fg:e.theme[3],bg:e.theme[2],title:e.theme[1],sx:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}}),filter:(e,t)=>t.id.toLowerCase().includes(e.toLowerCase())||Object.values(t.id).some((t=>t.toLowerCase().includes(e.toLowerCase()))),value:Ne.value,onChange:e=>Pe(e)})},{type:"custom",label:Z("header.settings.procedures.changeColor.changeTo"),component:r.jsx(B,{theme:Le,onClick:Ie})}]}];R.useEffect((()=>{n&&(ie(!1),de(!1),be(!1),ve(!1),we(!1),le(0),ze([se,..._(ee.current,X?[...Q].filter((e=>e.startsWith("stn")||e.startsWith("misc_node"))):ee.current.nodes(),X?[...Q].filter((e=>e.startsWith("line"))):ee.current.edges()).map((e=>({id:e.toString(),theme:e,value:"other"===e[1]?e[2]:e[1]})))]),Pe(se))}),[n]);return r.jsxs(s,{isOpen:n,onClose:A,size:"md",scrollBehavior:"inside",children:[r.jsx(a,{}),r.jsxs(i,{children:[r.jsxs(o,{children:[r.jsx(l,{as:"b",fontSize:"xl",children:Z(X?"panel.details.multipleSelection.change":"header.settings.procedures.changeType.title")}),r.jsx(c,{})]}),r.jsx(d,{children:r.jsx(u,{allowMultiple:!0,children:We.map((e=>r.jsxs(g,{children:[r.jsxs(h,{onClick:e.onClose,children:[r.jsx(p,{as:"span",flex:"1",textAlign:"left",children:r.jsx(l,{as:"b",fontSize:"md",children:e.title})}),r.jsx(y,{})]}),r.jsx(b,{pb:4,minH:420,children:r.jsx(F,{fields:e.field,minW:270})})]},e.id)))})}),r.jsxs(f,{children:[r.jsx(m,{colorScheme:"blue",variant:"outline",mr:"1",onClick:A,children:Z("cancel")}),r.jsx(j,{label:Z("header.settings.pro"),isOpen:!1,children:r.jsx(m,{colorScheme:"red",mr:"1",onClick:()=>{const e=null!=Y&&Y.includes("station")?[...Q].filter((e=>e.startsWith("stn"))):X?[]:ee.current.filterNodes((e=>e.startsWith("stn"))),t=null!=Y&&Y.includes("misc-node")?[...Q].filter((e=>e.startsWith("misc_node"))):X?[]:ee.current.filterNodes((e=>e.startsWith("misc_node"))),n=X?[...Q].filter((e=>e.startsWith("line"))):ee.current.edges();Y&&!Y.includes("station")||!ce||((e,t,n,r)=>{r.filter((n=>"any"===t||e.getNodeAttribute(n,"type")===t)).forEach((t=>{q(e,t,n)}))})(ee.current,ue,he,e),Y&&!Y.includes("line")||!ye||((e,t,n,r,s)=>{s.filter((n=>"any"===t||e.getEdgeAttribute(n,"style")===t)).forEach((t=>{K(e,t,n,r)}))})(ee.current,fe,je,Le,n),Y&&!Y.includes("line")||!Oe||((e,t,n,r,s)=>{r.filter((n=>"any"===t||e.getEdgeAttribute(n,"type")===t)).forEach((t=>{J(e,t,n,s)}))})(ee.current,xe,Ce,n,U),Te&&(Y&&!Y.includes("line")||((e,t,n,r)=>{r.filter((t=>S.has(e.getEdgeAttribute(t,"style")))).forEach((r=>{const s=e.getEdgeAttributes(r),a=s[s.style].color;("any"===t||a[0]==t[0]&&a[1]==t[1]&&a[2]==t[2]&&a[3]==t[3])&&e.mergeEdgeAttributes(r,{[s.style]:{color:n}})}))})(ee.current,"any"===Ne.id?"any":Ne.theme,Le,n),(!Y||Y.includes("misc-node")||Y.includes("station"))&&((e,t,n,r,s)=>{[...r,...s].forEach((r=>{const s=e.getNodeAttributes(r).type,a=e.getNodeAttribute(r,s);if(void 0!==a.color){const e=a.color;("any"===t||e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3])&&(a.color=n)}e.mergeNodeAttributes(r,{[s]:a})}))})(ee.current,"any"===Ne.id?"any":Ne.theme,Le,e,t)),ae&&((e,t,n,r,s)=>{[...t,...n].forEach((t=>{e.setNodeAttribute(t,"zIndex",s)})),r.forEach((t=>{e.setEdgeAttribute(t,"zIndex",s)}))})(ee.current,e,t,n,oe),$(),A()},isDisabled:!1,children:Z("apply")})})]})]})]})}))}}}))}();
